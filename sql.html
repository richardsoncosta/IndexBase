<!DOCTYPE html>
<html>

<head>
    <title>SQLs e comandos</title>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="estilo.css">
    <script>
        function checkAuth() {
            const user = localStorage.getItem('user');
            const timestamp = localStorage.getItem('timestamp');

            // Verifica se o usuário já está autenticado e se a autenticação ainda é válida (4 horas)
            if (user && timestamp && (Date.now() - timestamp < 4 * 60 * 60 * 1000)) {
                return true; // Usuário já autenticado
            }

            // Loop para solicitar credenciais até que o usuário acerte ou cancele
            while (true) {
                const username = prompt("Digite o nome de usuário:");
                if (username === null) {
                    // Usuário cancelou o prompt
                    alert("Autenticação cancelada.");
                    return false;
                }

                const password = prompt("Digite a senha:");
                if (password === null) {
                    // Usuário cancelou o prompt
                    alert("Autenticação cancelada.");
                    return false;
                }

                // Verifica se as credenciais estão corretas
                if (username === "SUPERVISOR" && password === "123456") {
                    localStorage.setItem('user', username); // Armazena o usuário
                    localStorage.setItem('timestamp', Date.now()); // Armazena o timestamp
                    return true; // Autenticação bem-sucedida
                } else {
                    alert("Usuário ou senha incorretos. Tente novamente.");
                }
            }
        }

        // Verifica a autenticação ao carregar a página
        if (!checkAuth()) {
            window.location.href = "about:blank"; // Redireciona para uma página em branco se a autenticação falhar
        }

        // Função para mostrar/ocultar o código
        function toggleCode(button) {
            const codeElement = button.previousElementSibling;
            if (codeElement.style.display === "none" || codeElement.style.display === "") {
                codeElement.style.display = "block";
                button.textContent = "Mostrar menos";
            } else {
                codeElement.style.display = "none";
                button.textContent = "Mostrar mais";
            }
        }
    </script>
</head>

<body>
    <div id="area-cabecalho">
        <div id="area-logo">
            <h1>Suporte</h1>
        </div>
        <div id="area-menu">
            <a href="index.html">Home</a>
            <a href="base.html">Base de Conhecimentos</a>
            <a href="tutoriais.html">Tutoriais</a>
            <a class="selecionado" href="sql.html">SQLs</a>
            <a href="downloads.html">Downloads</a>
        </div>
    </div>

    <div id="area-principal">
        <div id="area-sql">
            <div>
                <h2>SQLs e comandos CMD</h2>
                <br>
                <span class="descricao">Encontre SQLs e comandos</span>
                <br>
                <br>
                <br>
                <p>Nesta seção você vai encontrar um acervo de SQLs e comandos de uso rotineiro do suporte para as mais diversas situações</p>
                <br>
                <div>
                    <p class="buscar-conteudo">Buscar conteúdo</p>
                    por enquanto buscar não está funcionando, dê um <span class="negrito">CTRL+F</span>
                </div>
                <br>
                <br>
                <br>

                <!-- Início das postagens -->
                <div class="postagem">
                    <h4>SQL - Desbloqueio de tabela</h4>
                    <span class="descricao-sql">SQL para alterar uma Trigger que protege a integridade do banco de dados de alterações indevidas e desbloqueando as tabelas</span>
                    <br>
                    <br>
                    <pre class="codigo" style="display: none;">
ALTER TRIGGER TRIG_RDB$TRIGGERS_1 INACTIVE;
ALTER TRIGGER INS$caixa_abertura_turno INACTIVE;
                    </pre>
                    <button onclick="toggleCode(this)">Mostrar mais</button>
                    <br>
                    <br>
                    <hr>
                </div>

                <div class="postagem">
                    <h4>SQL - Reabrir caixa fechado no banco</h4>
                    <span class="descricao-sql">SQL para alterar o caixa_abertura_turno reabrindo um caixa já fechado</span>
                    <br>
                    <br>
                    <pre class="codigo" style="display: none;">
ALTER TRIGGER TRIG_RDB$TRIGGERS_1 INACTIVE;
ALTER TRIGGER INS$caixa_abertura_turno INACTIVE; 
--LINHA DE CODIGO PARA DESBLOQUER ALTERACOES NA TABELA

UPDATE CAIXA_ABERTURA_TURNO
SET FECHAMENTO_DATA=null,FECHAMENTO_HORA=null
WHERE COD_CAIXA_ABERTURA_TURNO='2447'
--LINHA DE CODIGO PARA ALTERAR O CAIXA
                    </pre>
                    <button onclick="toggleCode(this)">Mostrar mais</button>
                    <br>
                    <br>
                    <hr>
                </div>

                <div class="postagem">
                    <h4>CMD - Restore do Roteador</h4>
                    <span class="descricao-sql">Comando CMD para restore de banco de dados do roteador corrompido</span>
                    <br>
                    <br>
                    <pre class="codigo" style="display: none;">
SET ISC_USER=SYSDBA
SET ISC_PASSWORD=masterkey
GFIX -C ALL C:\REDESOFT\ROTEADOR\BANCO.FDB
GFIX -M -I C:\REDESOFT\ROTEADOR\BANCO.FDB
GBAK -G -B -V C:\REDESOFT\ROTEADOR\BANCO.FDB C:\REDESOFT\ROTEADOR\BKP_BANCO.GBK
GBAK -G -R -V -P 4096 C:\REDESOFT\ROTEADOR\BKP_BANCO.GBK C:\REDESOFT\ROTEADOR\BANCO_RECUPERADO.FDB
GFIX -V -F C:\REDESOFT\ROTEADOR\BANCO_RECUPERADO.FDB
                    </pre>
                    <button onclick="toggleCode(this)">Mostrar mais</button>
                    <br>
                    <br>
                    <hr>
                </div>

                <!-- Repetir a estrutura acima para todas as postagens restantes -->

            </div>
        </div>
    </div>
</body>

</html>
